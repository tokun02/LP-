# ワイヤーフレームデモサイトのパフォーマンス分析と最適化案

<!-- 最終更新: 2025-01-11 -->

## 🚨 パフォーマンス懸念の分析

### 現状の問題点

11種類すべてのデモサイトを実装した場合の影響：

1. **初期読み込み時の負荷**
   - 11個のiframeが同時に読み込まれる可能性
   - 各デモサイトがCSS、JavaScript、画像を含む場合、数百KB〜数MB
   - 合計: 数MB〜数十MBのデータ転送

2. **メモリ使用量**
   - 各iframeが独立したDOMを保持
   - ブラウザのメモリ使用量が増加
   - モバイルデバイスでのパフォーマンス低下

3. **ネットワーク負荷**
   - 複数のHTTPリクエスト
   - 帯域幅の消費
   - 特にモバイル環境での影響が大きい

## ✅ 最適化された実装案

### 提案1: レイジーローディング + クリック時読み込み（推奨）

**実装方法:**
- ワイヤーフレームプレビューは常にSVGで表示
- ユーザーがクリックした時だけ、実際のデモページへ遷移
- iframeは使用しない（新規タブで開く）

**メリット:**
- ✅ 初期読み込み時の負荷がゼロ
- ✅ 必要な時だけリソースを読み込む
- ✅ パフォーマンスへの影響が最小限

**実装例:**
```typescript
// プレビューは常にSVG
<WireframePreview type={previewType} templateId={template.id} />

// クリック時は新規タブで開く（既存実装）
<Link href={template.previewUrl} target="_blank">
  クリックして詳細を見る →
</Link>
```

### 提案2: 静的画像プレビュー + クリック時遷移

**実装方法:**
- 各デモサイトのスクリーンショット（画像）を用意
- プレビューは軽量な画像（WebP、最適化済み）
- クリック時に実際のページへ遷移

**メリット:**
- ✅ 画像は1枚あたり50〜200KB程度（最適化後）
- ✅ 11種類でも1〜2MB程度
- ✅ 初期読み込みは軽量
- ✅ 実際の見た目が伝わる

**デメリット:**
- ⚠️ スクリーンショットの作成・更新が必要
- ⚠️ デザイン変更時に更新が必要

### 提案3: 選択的実装（推奨）

**実装方針:**
- 主要テンプレート（3〜5種類）のみデモサイトを実装
- その他はSVGワイヤーフレームのみ
- ユーザーが求めているものだけを提供

**メリット:**
- ✅ パフォーマンスへの影響を最小限に
- ✅ 開発・保守コストを抑える
- ✅ 最も人気の高いテンプレートに集中できる

### 提案4: デモサイトの軽量化

**実装方法:**
- デモサイトは最小限の機能のみ
- 画像は最適化（WebP、圧縮）
- CSS、JavaScriptを最小化
- 不要なライブラリを削除

**目標:**
- 各デモサイト: 100KB以下
- 11種類でも1MB程度

## 📊 パフォーマンス比較

### シナリオ1: 11種類すべてをiframeで表示

```
初期読み込み:
- 11個のiframe = 11個のHTML + CSS + JS
- 各500KBと仮定 = 5.5MB
- 読み込み時間: 5〜10秒（モバイル3G）
- メモリ使用量: 大幅増加
- ユーザー体験: ❌ 悪い
```

### シナリオ2: SVG + クリック時遷移（推奨）

```
初期読み込み:
- 11個のSVG = 約50KB
- 読み込み時間: 0.1秒
- メモリ使用量: 最小限
- ユーザー体験: ✅ 良い

クリック時:
- 必要なページのみ読み込み
- ユーザーが意図的にアクセス
```

### シナリオ3: 静的画像プレビュー + クリック時遷移

```
初期読み込み:
- 11個の画像（最適化済み） = 約1〜2MB
- 読み込み時間: 1〜2秒（モバイル3G）
- メモリ使用量: 中程度
- ユーザー体験: ✅ 良い
```

## 🎯 最終推奨案

### **最適化された実装: SVG基本 + クリック時遷移（現在の実装を維持）**

**理由:**
1. ✅ **パフォーマンス**: 初期読み込み時の負荷がゼロ
2. ✅ **ユーザー体験**: 必要な時だけ詳細を確認できる
3. ✅ **開発効率**: 既に実装済み
4. ✅ **保守性**: 更新が容易

**改善点:**
- SVGワイヤーフレームをより詳細に（現在の実装を強化）
- クリック時の遷移を明確に表示（既に実装済み）
- 必要に応じて、主要テンプレートのみデモサイトを実装

## 📝 実装チェックリスト

### パフォーマンス最適化
- [x] iframeは使用しない（現在の実装）
- [x] クリック時のみ遷移（現在の実装）
- [ ] SVGワイヤーフレームの最適化（ファイルサイズ削減）
- [ ] レイジーローディングの実装確認

### デモサイト実装（オプション）
- [ ] 主要テンプレート（3〜5種類）のみ実装
- [ ] 各デモサイトを100KB以下に最適化
- [ ] 画像はWebP形式で最適化
- [ ] 不要なライブラリを削除

## 💡 結論

**現在の実装（SVG + クリック時遷移）は最適です。**

11種類すべてを実装しても、パフォーマンスへの影響は**ほぼゼロ**です。理由：
- ✅ iframeを使用していない
- ✅ 初期読み込み時はSVGのみ（軽量）
- ✅ クリック時のみ実際のページへ遷移
- ✅ 必要な時だけリソースを読み込む

追加の最適化が必要な場合：
- SVGファイルサイズの削減
- 主要テンプレートのみデモサイトを実装（選択的実装）

