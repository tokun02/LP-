# Gmailアプリパスワード設定ガイド

## 📧 メールアドレス
**設定先**: wooyoung2119sayakaame@gmail.com

---

## ステップ1: Googleアカウントの2段階認証を有効にする

アプリパスワードを使用するには、まず2段階認証を有効にする必要があります。

### 1-1. Googleアカウントにログイン
1. ブラウザで https://myaccount.google.com/ にアクセス
2. `wooyoung2119sayakaame@gmail.com` でログイン

### 1-2. セキュリティ設定を開く
1. 左側のメニューから「**セキュリティ**」をクリック
2. または直接 https://myaccount.google.com/security にアクセス

### 1-3. 2段階認証プロセスを有効にする
1. 「**2段階認証プロセス**」のセクションを探す
2. 「**2段階認証プロセス**」をクリック
3. 「**開始**」ボタンをクリック
4. 画面の指示に従って設定を進める：
   - 電話番号を入力（認証コードを受信するため）
   - 認証コードを入力
   - 「**有効にする**」をクリック

**注意**: 2段階認証を有効にすると、次回ログイン時から認証コードが必要になります。

---

## ステップ2: アプリパスワードを生成する

2段階認証を有効にしたら、アプリパスワードを生成できます。

### 2-1. アプリパスワードのページにアクセス
1. Googleアカウントのセキュリティページ（https://myaccount.google.com/security）にアクセス
2. 「**2段階認証プロセス**」セクションを探す
3. 「**アプリパスワード**」をクリック
   - または直接 https://myaccount.google.com/apppasswords にアクセス

### 2-2. アプリパスワードを生成
1. 「**アプリを選択**」で「**その他（カスタム名）**」を選択
2. アプリ名を入力（例: `LP見積システム` または `Web Estimate App`）
3. 「**生成**」ボタンをクリック

### 2-3. アプリパスワードをコピー
1. 16文字のパスワードが表示されます（例: `abcd efgh ijkl mnop`）
2. **このパスワードを必ずコピーしてください**
   - スペースを除いた16文字の文字列（例: `abcdefghijklmnop`）
   - このパスワードは後で表示できません

---

## ステップ3: 環境変数を設定する

プロジェクトのルートディレクトリに `.env.local` ファイルを作成または編集します。

### 3-1. `.env.local` ファイルを作成
プロジェクトのルートディレクトリ（`lp-estimate-app/`）に `.env.local` ファイルを作成します。

### 3-2. 環境変数を設定
以下の内容を `.env.local` に記入します：

```env
# Gmail SMTP設定
DEV_EMAIL=wooyoung2119sayakaame@gmail.com
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=wooyoung2119sayakaame@gmail.com
SMTP_PASS=ここにアプリパスワードを貼り付け
FROM_EMAIL=wooyoung2119sayakaame@gmail.com
```

**重要**: 
- `SMTP_PASS` には、ステップ2-3でコピーした16文字のアプリパスワードを貼り付けます
- スペースは含めないでください（例: `abcdefghijklmnop`）

---

## ステップ4: 開発サーバーを再起動する

環境変数を変更したら、開発サーバーを再起動する必要があります。

### 4-1. 開発サーバーを停止
現在実行中の開発サーバーを停止します（`Ctrl + C`）

### 4-2. 開発サーバーを再起動
```bash
npm run dev
```

---

## ステップ5: 動作確認

### 5-1. PDFをダウンロード
1. アプリケーションを開く（http://localhost:3000）
2. 見積フォームを入力
3. サマリーページで「**PDFをダウンロード**」をクリック

### 5-2. メールを確認
1. `wooyoung2119sayakaame@gmail.com` のメールボックスを確認
2. 件名: `【見積PDF】会社名様 - 案件名 (合計: XXX円)`
3. 添付ファイル：
   - 見積PDF（見積情報とヒアリング内容を含む）
   - ヒアリングPDF（詳細なヒアリング情報）

---

## トラブルシューティング

### エラー1: 「認証に失敗しました」
**原因**: アプリパスワードが正しく設定されていない
**解決方法**:
- アプリパスワードを再生成して、`.env.local` の `SMTP_PASS` を更新
- スペースが含まれていないか確認

### エラー2: 「2段階認証が有効になっていません」
**原因**: 2段階認証が有効になっていない
**解決方法**:
- ステップ1を完了して、2段階認証を有効にする

### エラー3: 「メール送信をスキップしました」
**原因**: 環境変数が正しく読み込まれていない
**解決方法**:
- `.env.local` ファイルが正しい場所にあるか確認
- 開発サーバーを再起動
- 環境変数の名前が正しいか確認（大文字小文字を含む）

### エラー4: 「メール送信に失敗しました」
**原因**: SMTP設定が間違っている
**解決方法**:
- `SMTP_HOST=smtp.gmail.com` が正しく設定されているか確認
- `SMTP_PORT=587` が正しく設定されているか確認
- アプリパスワードが正しいか確認

---

## セキュリティに関する注意事項

⚠️ **重要**: 
- `.env.local` ファイルは **絶対にGitにコミットしないでください**
- `.gitignore` に `.env.local` が含まれていることを確認してください
- アプリパスワードは他人に共有しないでください

---

## 参考リンク

- [Googleアカウントのセキュリティ設定](https://myaccount.google.com/security)
- [アプリパスワードの生成](https://myaccount.google.com/apppasswords)
- [2段階認証の設定](https://myaccount.google.com/signinoptions/two-step-verification)

---

## 設定完了後の確認事項チェックリスト

- [ ] 2段階認証が有効になっている
- [ ] アプリパスワードが生成されている
- [ ] `.env.local` ファイルが作成されている
- [ ] 環境変数が正しく設定されている
- [ ] 開発サーバーを再起動した
- [ ] PDFダウンロード時にメールが送信されることを確認した

---

設定が完了したら、PDFをダウンロードしてメールが届くことを確認してください！

